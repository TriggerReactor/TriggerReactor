import org.yaml.snakeyaml.Yaml

apply plugin: 'java'
apply plugin: 'groovy'
apply plugin: 'eclipse'

configurations {
	jaxDoclet
}

buildscript {
  	ext.bukkit_version = "1.12-R0.1-SNAPSHOT"
  	ext.plugin_version = "0.1.0"
  	
  	repositories {
		jcenter()
	}
	
  	dependencies {
		classpath 'org.yaml:snakeyaml:1.15'
    }
}

repositories {
	jcenter()
	mavenCentral()
	maven {
		url "https://hub.spigotmc.org/nexus/content/repositories/snapshots/"
	}
	maven {
		url "http://nexus.hc.to/content/repositories/pub_releases/"
	}
	maven {
		url "https://oss.sonatype.org/content/repositories/snapshots"
	}
}


sourceSets {
	main {
		java {
			srcDirs = ['src/main/java']
		}
		resources {
			srcDirs = ['src/main/resources']
			include 'Executor/*.js'
			include 'Executor/*/*.js'
			include '*.yml'
		}
	}
	
	test{
	 	java {
            srcDirs = ['src/test/java/']
        }
	}
}

dependencies {
	compile fileTree(dir: "libs", includes: ['*.jar'])
	
	compile "org.spigotmc:spigot-api:$bukkit_version"
	
	compile "net.milkbowl.vault:VaultAPI:1.6"
	
    testCompile 'junit:junit:4.+'
    testCompile 'org.mockito:mockito-core:2.+'
}

task fileYaml {
	doLast{
		def yaml = new Yaml()
		def doc = new File("./src/main/resources/plugin.yml")
		def map = (Map) yaml.load(doc)
		map["version"] = "$plugin_version"
		def newYaml = yaml.dump(map)
		println(newYaml)
		def newDoc = new File("./src/main/resources/plugin.yml")
		newDoc.write(newYaml);
	}
}

javadoc {
	source = sourceSets.main.allJava
	classpath = configurations.compile
	failOnError = false
	options { 
       links "http://docs.oracle.com/javase/8/docs/api/" 
       links "https://hub.spigotmc.org/javadocs/bukkit/"
    } 
}
